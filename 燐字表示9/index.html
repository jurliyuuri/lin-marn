<head>
<script>
var t1 = [[ 3.71500000e+02,  1.18631579e+02, -7.77777778e-01],
 [ 8.62000000e+02,  3.68421053e-01,  1.68777778e+02]];

var t2 = [[ 9.08750000e+02,  1.18657895e+02, -1.05555556e+00],
 [ 8.07500000e+01,  6.05263158e-01,  1.68611111e+02]];

var t3 = [[ 7.60000000e+02,  1.18736842e+02, -8.88888889e-01],
 [ 3.54250000e+02,  3.42105263e-01,  1.68833333e+02]];

onload = function() {
	for(var i=0; i<20; i++){
		for(var j=0;j<10; j++){
		draw(t1,linzi1,'c1',i,j, 0.54, i*70, j*70, true);	
		}
	}
	for(var i=0; i<20; i++){
		for(var j=0;j<10; j++){
		draw(t2,linzi2,'c3',i,j, 0.54, i*70, j*70, true);	
		}
	}
	for(var i=0; i<20; i++){
		for(var j=0;j<10; j++){
		draw(t3,linzi3,'c4',i,j, 0.54, i*70, j*70, true);	
		}
	}
	/*var flag = false;
	draw(flag?t1:t2,flag?linzi1:linzi2,'c2',Math.random()*8|0,Math.random()*15|0,0.4,0,0,false);*/
	
};


</script>
<script src="main.js"></script>
</head>
<body>
<div style="background-color: yellow">
<canvas id="c1" width="2400" height="1240" ></canvas>
<hr>
<canvas id="c3" width="2400" height="1240" ></canvas>
<hr>
<canvas id="c4" width="2400" height="1240" ></canvas>
<hr>
<canvas id="c2" width="240" height="240" style="border:1px solid black"></canvas>
</div>
<hr>
<h1>「第1回燐字風字書き取り」分割</h1>
<h2>1. さて</h2>
<p>1枚目の原稿用紙の表の4頂点に位置する4字の（マスの左上の）座標をGIMPで取ると</p>
<p>実験をすると</p>
<pre>
      y1,   y2       s1 s2
左上:  372,  862 --->  0, 0
右上: 2625,  869 ---> 19, 0
左下:  364, 2381 --->  0, 9
右下: 2619, 2388 ---> 19, 9
</pre>
<p>である。うまいパラメータt<sub>10</sub>, t<sub>11</sub>, t<sub>12</sub>, t<sub>20</sub>, t<sub>21</sub>, t<sub>22</sub>を持ってきて、</p>
<img src="matrix.png" width="780"/>
<p>となるようにしてやれば良い。ただしs<sub>0</sub>たちは全部1である。</p>
<p>Y ≒ TSで最小二乗法をやるのでYS<sup>T</sup>=TSS<sup>T</sup>を解けばよく、T=YS<sup>T</sup>(SS<sup>T</sup>)<sup>-1</sup>なのでTは</p>
<pre>
 [[ 3.71500000e+02,  1.18631579e+02, -7.77777778e-01],
 [ 8.62000000e+02,  3.68421053e-01,  1.68777778e+02]]
</pre>
<p>なるほど。実際にやってみると上手くいったのでやったぜ。</p>
<p>さて、二枚目の原稿用紙も同様にやっていこう。実験をすると</p>
<pre>
       y1,   y2      s1 s2
左上:  908,   81 --->  0, 0
右上: 3164,   92 ---> 19, 0
左下:  900, 1598 --->  0, 9
右下: 3153, 1610 ---> 19, 9
</pre>
<p>なのでTは</p>
<pre>
[[ 9.08750000e+02,  1.18657895e+02, -1.05555556e+00],
 [ 8.07500000e+01,  6.05263158e-01,  1.68611111e+02]]
</pre>
<p>だそうだ。</p>

<p>三枚目の原稿用紙も同様にやっていこう。実験をすると</p>
<pre>
       y1,   y2      s1 s2
左上:  760,  354 --->  0, 0
右上: 3016,  361 ---> 19, 0
左下:  752, 1874 --->  0, 9
右下: 3008, 1880 ---> 19, 9
</pre>
<p>なのでTは</p>
<pre>
[[ 7.60000000e+02,  1.18736842e+02, -8.88888889e-01],
 [ 3.54250000e+02,  3.42105263e-01,  1.68833333e+02]]
</pre>
<p>だそうだ。</p>



<h2>3. 分割して保存</h2>
<p>それぞれの画像に分割して保存していかねば。</p>
<p>今回もPythonを使う。</p>
<p>なお「纂　⿰筆軸」と「穐　⿰⿱五米刀」ができた模様。足さなきゃ。</p>

</body>
